<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2D Minecraft-Like Desktop</title>
  <style>
    html, body { margin: 0; height: 100%; background:#0f172a; color:#e2e8f0; font-family: system-ui, sans-serif; }
    #ui { position: fixed; inset: 0; pointer-events: none; }
    .panel { position: absolute; left: 50%; transform: translateX(-50%); bottom: 16px; background: rgba(2,6,23,.7); border:1px solid rgba(148,163,184,.25); padding: 8px 12px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,.35); pointer-events:auto }
    .row { display:flex; gap:8px; align-items:center }
    .btn { pointer-events:auto; background:#1f2937; border:1px solid #334155; padding:6px 10px; border-radius:10px; color:#e5e7eb; cursor:pointer; font-size:14px }
    .btn:hover { background:#374151 }
    .hotbar { display:flex; gap:6px }
    .slot { width:44px; height:44px; border-radius:10px; border:2px solid #475569; display:flex; align-items:center; justify-content:center; position:relative; background:#111827 }
    .slot.selected { border-color:#fbbf24; box-shadow:0 0 0 2px rgba(251,191,36,.3) inset }
    .slot .count { position:absolute; right:6px; bottom:4px; font-size:12px; color:#cbd5e1 }
    .legend { position:absolute; top:12px; left:12px; background:rgba(2,6,23,.65); border:1px solid rgba(148,163,184,.25); padding:10px 12px; border-radius:12px; font-size:14px; line-height:1.45; max-width: 460px; pointer-events:auto }
    .legend kbd { background:#0b1220; border:1px solid #394962; padding:2px 6px; border-radius:6px; font-size:12px }
    .seedpanel { position:absolute; right:12px; top:12px; background:rgba(2,6,23,.65); border:1px solid rgba(148,163,184,.25); padding:10px 12px; border-radius:12px; pointer-events:auto }
    .toggleSeed { position: absolute; left:12px; bottom:12px; pointer-events:auto }
    canvas { display:block; width:100vw; height:100vh; image-rendering: pixelated; }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="ui">
    <div class="legend">
      <div style="font-weight:700; margin-bottom:6px">2D Minecraft-like — Desktop</div>
      <div>Move <kbd>A</kbd>/<kbd>D</kbd>, Jump <kbd>Space</kbd>. Break <kbd>Left-Click</kbd>, Place <kbd>Right-Click</kbd> (or <kbd>Shift+Left</kbd>). Hotbar <kbd>1-8</kbd>.</div>
    </div>
    <div class="seedpanel" id="seedpanel">
      <div style="font-weight:600; margin-bottom:6px">World</div>
      <div style="display:flex; gap:6px; align-items:center">
        <input id="seedInput" placeholder="Seed / World ID" style="pointer-events:auto; background:#0b1220; color:#e5e7eb; border:1px solid #334155; border-radius:8px; padding:6px 8px; width:180px"/>
        <button class="btn" id="btnNew">Enter World</button>
        <button class="btn" id="btnRandom">Random</button>
      </div>
    </div>
    <button class="btn toggleSeed" id="btnToggleSeed" style="display:none">⚙ World Settings</button>
    <div class="panel"><div class="row hotbar" id="hotbar"></div></div>
  </div>

  <script>
  const TILE_SIZE=24, WORLD_W=256, WORLD_H=128;
  const GRAVITY=0.45, MAX_FALL=12, JUMP_VELOCITY=-6.5;

  function xmur3(str){ let h=1779033703^str.length; for(let i=0;i<str.length;i++){h=Math.imul(h^str.charCodeAt(i),3432918353); h=h<<13|h>>>19;} return function(){h=Math.imul(h^h>>>16,2246822507); h=Math.imul(h^h>>>13,3266489909); return (h^h>>>16)>>>0; } }
  function mulberry32(a){ return function(){ let t=a+=0x6D2B79F5; t=Math.imul(t^t>>>15, t|1); t^=t+Math.imul(t^t>>>7, t|61); return ((t^t>>>14)>>>0)/4294967296; } }
  function lerp(a,b,t){ return a+(b-a)*t } function smoothstep(t){ return t*t*(3-2*t) }
  function noise1D(seed){ const rnd = mulberry32(xmur3(seed||'0')()); const p = Array.from({length:1024},()=>rnd()); return x=>{ const x0=Math.floor(x)%1024; const x1=(x0+1)%1024; const t = smoothstep(x-Math.floor(x)); return lerp(p[x0], p[x1], t); } }

  const Blocks={AIR:0,GRASS:1,DIRT:2,STONE:3,WOOD:4,LEAVES:5,SAND:6,BRICK:7};
  const BLOCK_COLORS={0:'rgba(0,0,0,0)',1:'#3aa655',2:'#6b4f2a',3:'#8b8f99',4:'#8c5a2b',5:'#4caf50',6:'#d9c074',7:'#b34a4a'};
  const SOLID=new Set([1,2,3,4,5,6,7]);
  const HOTBAR=[2,3,4,5,6,7,1];

  let seed=String(Math.floor(Math.random()*1e9));
  let world=new Uint16Array(WORLD_W*WORLD_H);
  const inv={}; HOTBAR.forEach(b=>inv[b]=0);
  const player={x:WORLD_W/2,y:18,vx:0,vy:0,w:0.8,h:1.8,facing:1,color:'#ffdd99'};
  const cam={x:0,y:0,scale:1};
  const keys={}; let mouse={x:0,y:0,left:false,right:false,placeWithShift:false};

  const canvas=document.getElementById('game'); const ctx=canvas.getContext('2d');
  function resize(){canvas.width=innerWidth;canvas.height=innerHeight;} addEventListener('resize',resize);resize();

  function index(x,y){return y*WORLD_W+x}
  function inBounds(x,y){return x>=0&&x<WORLD_W&&y>=0&&y<WORLD_H}

  function generateWorld(){
    const noise=noise1D(seed);
    for(let x=0;x<WORLD_W;x++){
      const h=Math.floor(80+noise(x*0.05)*20);
      for(let y=0;y<WORLD_H;y++){
        let id=Blocks.AIR;
        if(y>h) id=Blocks.AIR; else if(y===h) id=Blocks.GRASS; else if(y>h-3) id=Blocks.DIRT; else id=Blocks.STONE;
        world[index(x,y)]=id;
      }
    }
  }

  function applyBlock(x,y,id){ if(!inBounds(x,y)) return; world[index(x,y)] = id; }

  function enterWorld(){
    seed=(document.getElementById('seedInput').value.trim()||seed);
    generateWorld();
    document.getElementById('seedpanel').style.display='none';
    document.getElementById('btnToggleSeed').style.display='inline-block';
    player.x=WORLD_W/2; player.y=18; player.vx=player.vy=0;
  }

  document.getElementById('btnNew').onclick=enterWorld;
  document.getElementById('btnRandom').onclick=()=>{ seed=String(Math.floor(Math.random()*1e9)); document.getElementById('seedInput').value=seed; };
  document.getElementById('btnToggleSeed').onclick=()=>{ const visible=document.getElementById('seedpanel').style.display!=='none'; document.getElementById('seedpanel').style.display=visible?'none':'block'; };

  function step(){
    if(keys['a']) player.vx=-0.1; else if(keys['d']) player.vx=0.1; else player.vx=0;
    if(keys[' ']&&player.onGround){ player.vy=JUMP_VELOCITY; player.onGround=false; }
    player.vy+=GRAVITY; if(player.vy>MAX_FALL) player.vy=MAX_FALL;

    player.x+=player.vx*5;
    player.y+=player.vy*0.5;
    if(player.y>WORLD_H-5) player.y=WORLD_H-5, player.vy=0, player.onGround=true;

    cam.x=player.x; cam.y=player.y;
  }

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const scale=32; ctx.save(); ctx.scale(scale,scale);
    ctx.translate(canvas.width/scale/2-cam.x,canvas.height/scale/2-cam.y);
    for(let x=0;x<WORLD_W;x++){ for(let y=0;y<WORLD_H;y++){ const id=world[index(x,y)]; if(id!==0){ ctx.fillStyle=BLOCK_COLORS[id]; ctx.fillRect(x,y,1,1);} } }
    ctx.fillStyle=player.color; ctx.fillRect(player.x-0.4,player.y-1.8,0.8,1.8);
    ctx.restore();
  }

  function loop(){ step(); draw(); requestAnimationFrame(loop);} generateWorld(); loop();
  onkeydown=e=>keys[e.key.toLowerCase()]=true;
  onkeyup=e=>keys[e.key.toLowerCase()]=false;
  </script>
</body>
</html>
